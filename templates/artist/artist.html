{{define "artist.html"}}
{{template "layout" .}}
{{end}}

{{define "head"}}
<link rel="stylesheet" href="/assets/styles/artist/artist.css">
{{end}}

{{define "content"}}
<div class="artist-page">
    <!-- En-tête de l'artiste -->
    <div class="artist-header">
        <div class="container">
            <div class="artist-header__content">
                <div class="artist-avatar">
                    <img src="{{.Artist.Image}}" alt="{{.Artist.Name}}" class="artist-image">
                    <div class="artist-badges">
                        <span class="badge">Depuis {{.Artist.CreationDate}}</span>
                        <span class="badge">1er album: {{.Artist.FirstAlbum}}</span>
                    </div>
                </div>
                <div class="artist-info">
                    <h1 class="artist-name">{{.Artist.Name}}</h1>
                    <p class="artist-meta">
                        <span>{{len .Artist.Members}} membre{{if gt (len .Artist.Members) 1}}s{{end}}</span>
                        <span>•</span>
                        <span>{{len .Artist.Concerts}} lieux de concert</span>
                    </p>
                    
                    <div class="artist-members">
                        {{range .Artist.Members}}
                        <div class="member">
                            <i class="fas fa-user"></i>
                            <span>{{.}}</span>
                        </div>
                        {{end}}
                    </div>
                    
                    <a href="/home" class="back-link">
                        <i class="fas fa-arrow-left"></i>
                        <span>Retour à la liste</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Navigation secondaire -->
    <nav class="artist-nav">
        <div class="container">
            <ul>
                <li><a href="#concerts" class="active">Concerts</a></li>
                <li><a href="#carte">Carte des tournées</a></li>
                <li><a href="#albums">Discographie</a></li>
                <li><a href="#membres">Membres</a></li>
            </ul>
        </div>
    </nav>
    
    <!-- Section principale -->
    <div class="container">
        <div class="artist-main">
            <!-- Section Carte -->
            <section id="carte" class="section-map">
                <div class="section-header">
                    <h2><i class="fas fa-map-marked-alt"></i> Carte des tournées</h2>
                    <p>Visualisez les lieux de concert sur la carte</p>
                </div>
                <div class="map-container">
                    <div id="artist-map" class="map-wrapper">
                        <div class="map-loading">
                            <div class="spinner"></div>
                            <p>Chargement de la carte...</p>
                        </div>
                    </div>
                    <div class="map-legend">
                        <div class="legend-item">
                            <span class="legend-color" style="background: var(--accent);"></span>
                            <span>Concerts à venir</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background: var(--muted);"></span>
                            <span>Concerts passés</span>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Section Concerts -->
            <section id="concerts" class="section-concerts">
                <div class="section-header">
                    <h2><i class="fas fa-calendar-alt"></i> Prochains concerts</h2>
                    <p>Découvrez les dates de tournée à venir et réservez vos places</p>
                </div>
                
                <div class="concerts-list" id="upcoming-concerts-list">
                    <!-- Les concerts seront chargés dynamiquement par JavaScript -->
                </div>
            </section>
            
            <!-- Section Membres -->
            <section id="membres" class="section-members">
                <div class="section-header">
                    <h2><i class="fas fa-users"></i> Membres du groupe</h2>
                    <p>Découvrez les artistes qui composent le groupe</p>
                </div>
                
                <div class="members-grid">
                    {{range $index, $member := .Artist.Members}}
                    <div class="member-card" data-member-name="{{$member}}" data-member-index="{{$index}}" style="cursor: pointer;">
                        <div class="member-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <h3>{{$member}}</h3>
                        <p>Membre</p>
                        <div class="member-card-hover">
                            <i class="fas fa-info-circle"></i>
                            <span>Cliquez pour plus d'infos</span>
                        </div>
                    </div>
                    {{end}}
                </div>
            </section>
        </div>
        
        <!-- Sidebar -->
        <aside class="artist-sidebar">
            <div class="sidebar-widget">
                <h3><i class="fas fa-chart-line"></i> Statistiques</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <i class="fas fa-calendar-alt"></i>
                        <div>
                            <span class="stat-value" id="quick-upcoming-count">-</span>
                            <span class="stat-label">Concerts à venir</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-music"></i>
                        <div>
                            <span class="stat-value">{{len .Artist.Concerts}}</span>
                            <span class="stat-label">Lieux visités</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-calendar-check"></i>
                        <div>
                            <span class="stat-value">
                                {{$totalDates := 0}}
                                {{range .Artist.Concerts}}{{$totalDates = add $totalDates (len .Dates)}}{{end}}
                                {{$totalDates}}
                            </span>
                            <span class="stat-label">Dates de concert</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-globe-americas"></i>
                        <div>
                            <span class="stat-value">
                                {{$locations := makeSlice}}
                                {{range .Artist.Concerts}}
                                    {{if not (in $locations .DisplayLocation)}}
                                        {{$locations = append $locations .DisplayLocation}}
                                    {{end}}
                                {{end}}
                                {{len $locations}}
                            </span>
                            <span class="stat-label">Lieux uniques</span>
                        </div>
                    </div>
                </div>
            </div>
        </aside>
    </div>
</div>
{{end}}

{{define "pageScripts"}}
<script>
// Passer les données de l'artiste au JavaScript
window.__ARTIST = {{toJSON .Artist}};

// Fonction utilitaire pour formater les dates
function formatDate(dateString, format) {
    const date = new Date(dateString);
    const options = { 
        day: '2-digit', 
        month: format === 'short' ? 'short' : 'long',
        year: 'numeric'
    };
    return date.toLocaleDateString('fr-FR', options);
}

// Fonction pour faire défiler jusqu'à un élément
function scrollToElement(selector, offset = 120) {
    const element = document.querySelector(selector);
    if (element) {
        const headerHeight = 80; // Hauteur du header
        const totalOffset = headerHeight + offset;
        const elementPosition = element.getBoundingClientRect().top + window.pageYOffset;
        const offsetPosition = elementPosition - totalOffset;
        window.scrollTo({
            top: Math.max(0, offsetPosition),
            behavior: 'smooth'
        });
    }
}

document.addEventListener('DOMContentLoaded', function() {
    // Gestion de la navigation secondaire
    const navLinks = document.querySelectorAll('.artist-nav a');
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const target = this.getAttribute('href');
            navLinks.forEach(l => l.classList.remove('active'));
            this.classList.add('active');
            scrollToElement(target);
        });
    });
    
    // Gestion du clic sur le bouton "Voir sur la carte"
    document.querySelectorAll('.concert-card .btn:not(:disabled)').forEach(button => {
        button.addEventListener('click', function() {
            const coordsStr = this.getAttribute('data-coords');
            if (!coordsStr) return;
            
            const coords = coordsStr.split(',');
            if (coords.length !== 2) return;
            
            const lat = parseFloat(coords[0]);
            const lng = parseFloat(coords[1]);
            
            if (isNaN(lat) || isNaN(lng)) {
                console.error('Coordonnées invalides:', coordsStr);
                return;
            }
            
            // Utiliser la carte globale (artistMap ou map)
            const mapInstance = window.artistMap || window.map;
            if (!mapInstance) {
                console.error('Carte non initialisée');
                return;
            }
            
            // Centrer la carte sur les coordonnées
            mapInstance.setView([lat, lng], 13, {
                animate: true,
                duration: 0.5
            });
            
            // Trouver et activer le marqueur correspondant
            const markers = window.artistMarkers || window.markers || [];
            if (Array.isArray(markers)) {
                const marker = markers.find(m => {
                    const markerLatLng = m.getLatLng();
                    const tolerance = 0.001;
                    return Math.abs(markerLatLng.lat - lat) < tolerance && 
                           Math.abs(markerLatLng.lng - lng) < tolerance;
                });
                
                if (marker) {
                    // Ouvrir le popup
                    marker.openPopup();
                    
                    // Animation de surbrillance
                    const icon = marker.getElement();
                    if (icon) {
                        icon.style.transition = 'transform 0.3s ease';
                        icon.style.transform = 'scale(1.5) rotate(-45deg)';
                        setTimeout(() => {
                            icon.style.transform = 'scale(1) rotate(-45deg)';
                        }, 500);
                    }
                }
            }
            
            // Faire défiler jusqu'à la carte avec un offset correct
            setTimeout(() => {
                scrollToElement('#carte', 120);
            }, 300);
        });
    });
    
    // Détection du défilement pour la navigation secondaire
    let scrollTimeout;
    window.addEventListener('scroll', function() {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(() => {
            const scrollPosition = window.scrollY;
            const headerHeight = 80;
            const navHeight = 60;
            const totalOffset = headerHeight + navHeight;
            
            document.querySelectorAll('section[id]').forEach(section => {
                const sectionTop = section.getBoundingClientRect().top + window.pageYOffset;
                const sectionHeight = section.offsetHeight;
                const sectionId = '#' + section.getAttribute('id');
                
                if (scrollPosition + totalOffset >= sectionTop - 50 && 
                    scrollPosition + totalOffset < sectionTop + sectionHeight - 50) {
                    const currentNavLink = document.querySelector(`.artist-nav a[href="${sectionId}"]`);
                    if (currentNavLink) {
                        navLinks.forEach(link => link.classList.remove('active'));
                        currentNavLink.classList.add('active');
                    }
                }
            });
        }, 50);
    });
    
    // Charger et afficher les prochains concerts après un court délai pour s'assurer que tout est prêt
    setTimeout(() => {
        loadUpcomingConcerts();
    }, 100);
    
    // Ajouter les event listeners pour les cartes de membres après un court délai
    setTimeout(() => {
        if (typeof setupMemberCards === 'function') {
            setupMemberCards();
        } else {
            console.error('Fonction setupMemberCards non disponible');
        }
    }, 300);
});

// Fonction pour configurer les cartes de membres
function setupMemberCards() {
    console.log('Configuration des cartes de membres...');
    const memberCards = document.querySelectorAll('.member-card');
    console.log(`Nombre de cartes trouvées: ${memberCards.length}`);
    
    memberCards.forEach(card => {
        card.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            const memberName = this.getAttribute('data-member-name');
            console.log('Clic sur membre:', memberName);
            if (memberName) {
                if (typeof openMemberModal === 'function') {
                    openMemberModal(memberName);
                } else {
                    console.error('Fonction openMemberModal non disponible');
                    alert('Fonctionnalité en cours de chargement...');
                }
            }
        });
    });
}

// Fonction pour charger les prochains concerts
function loadUpcomingConcerts() {
    console.log('Chargement des prochains concerts...');
    const artist = window.__ARTIST;
    
    if (!artist) {
        console.error('Données artiste non disponibles');
        const concertsList = document.getElementById('upcoming-concerts-list');
        if (concertsList) {
            concertsList.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-calendar-times"></i>
                    <p>Données artiste non disponibles</p>
                </div>
            `;
        }
        return;
    }
    
    if (!artist.concerts || artist.concerts.length === 0) {
        console.log('Aucun concert trouvé pour cet artiste');
        const concertsList = document.getElementById('upcoming-concerts-list');
        if (concertsList) {
            concertsList.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-calendar-times"></i>
                    <p>Aucun concert prévu pour le moment</p>
                </div>
            `;
        }
        return;
    }
    
    console.log(`Traitement de ${artist.concerts.length} concerts...`);
    console.log('Données des concerts:', artist.concerts);
    
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    console.log('Date d\'aujourd\'hui:', today);
    
    const upcomingConcerts = [];
    let totalDatesChecked = 0;
    let datesParsed = 0;
    let datesInFuture = 0;
    
    // Filtrer les concerts à venir
    artist.concerts.forEach((concert, concertIndex) => {
        if (!concert.dates || concert.dates.length === 0) {
            console.log(`Concert ${concertIndex}: pas de dates`, concert);
            return;
        }
        
        console.log(`Concert ${concertIndex}: ${concert.dates.length} dates`, concert.displayLocation || concert.location);
        
        concert.dates.forEach(dateStr => {
            totalDatesChecked++;
            try {
                const parts = dateStr.split('-');
                if (parts.length !== 3) {
                    console.warn(`Format de date invalide (pas 3 parties): ${dateStr}`);
                    return;
                }
                
                const [day, month, year] = parts.map(Number);
                
                if (isNaN(day) || isNaN(month) || isNaN(year)) {
                    console.warn(`Date contient des NaN: ${dateStr}`, {day, month, year});
                    return;
                }
                
                const fullYear = year < 100 ? 2000 + year : year;
                const concertDate = new Date(fullYear, month - 1, day);
                concertDate.setHours(0, 0, 0, 0);
                
                datesParsed++;
                
                console.log(`Date analysée: ${dateStr} -> ${concertDate.toISOString()}, Comparaison: ${concertDate >= today ? 'FUTUR' : 'PASSÉ'}`);
                
                if (concertDate >= today) {
                    datesInFuture++;
                    upcomingConcerts.push({
                        ...concert,
                        date: dateStr,
                        concertDate: concertDate
                    });
                }
            } catch (e) {
                console.warn('Erreur de parsing de date:', dateStr, e);
            }
        });
    });
    
    console.log(`Résumé: ${totalDatesChecked} dates vérifiées, ${datesParsed} parsées, ${datesInFuture} dans le futur`);
    console.log(`${upcomingConcerts.length} concerts à venir trouvés`);
    
    // Trier par date
    upcomingConcerts.sort((a, b) => a.concertDate - b.concertDate);
    
    const concertsList = document.getElementById('upcoming-concerts-list');
    if (!concertsList) {
        console.error('Élément upcoming-concerts-list introuvable');
        return;
    }
    
    // Afficher un message de chargement
    concertsList.innerHTML = `
        <div class="loading-concerts">
            <div class="spinner"></div>
            <p>Chargement des prochains concerts...</p>
        </div>
    `;
    
    // Attendre un peu pour l'animation
    setTimeout(() => {
        // Si aucun concert à venir, afficher tous les concerts (passés inclus) triés par date
        if (upcomingConcerts.length === 0) {
            console.log('Aucun concert à venir, affichage de tous les concerts...');
            const allConcerts = [];
            
            artist.concerts.forEach(concert => {
                if (!concert.dates || concert.dates.length === 0) return;
                
                concert.dates.forEach(dateStr => {
                    try {
                        const [day, month, year] = dateStr.split('-').map(Number);
                        const fullYear = year < 100 ? 2000 + year : year;
                        const concertDate = new Date(fullYear, month - 1, day);
                        concertDate.setHours(0, 0, 0, 0);
                        
                        allConcerts.push({
                            ...concert,
                            date: dateStr,
                            concertDate: concertDate
                        });
                    } catch (e) {
                        console.warn('Erreur de parsing de date:', dateStr, e);
                    }
                });
            });
            
            // Trier par date (plus récent en premier)
            allConcerts.sort((a, b) => b.concertDate - a.concertDate);
            
            if (allConcerts.length === 0) {
                concertsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calendar-times"></i>
                        <p>Aucun concert trouvé pour cet artiste</p>
                    </div>
                `;
                return;
            }
            
            // Utiliser tous les concerts comme concerts à afficher
            const concertsToDisplay = allConcerts.slice(0, 10); // Limiter à 10 plus récents
            
            // Mettre à jour le compteur
            const quickCount = document.getElementById('quick-upcoming-count');
            if (quickCount) {
                quickCount.textContent = concertsToDisplay.length;
            }
            
            // Afficher les concerts
            concertsList.innerHTML = concertsToDisplay.map((concert, index) => {
                const dateFormatted = formatConcertDate(concert.date);
                const time = generateRandomTime();
                const price = generateRandomPrice();
                
                const locationParts = (concert.displayLocation || concert.location || '').split(',');
                const city = locationParts.length > 1 ? locationParts[locationParts.length - 2].trim() : '';
                const country = locationParts.length > 0 ? locationParts[locationParts.length - 1].trim() : '';
                
                const [day, month, year] = concert.date.split('-').map(Number);
                const fullYear = year < 100 ? 2000 + year : year;
                const dateObj = new Date(fullYear, month - 1, day);
                const monthsShort = ['JAN', 'FÉV', 'MAR', 'AVR', 'MAI', 'JUN', 'JUL', 'AOÛ', 'SEP', 'OCT', 'NOV', 'DÉC'];
                const dayNum = day.toString().padStart(2, '0');
                const monthShort = monthsShort[month - 1];
                
                const concertData = {
                    location: concert.displayLocation || concert.location,
                    city: city || '',
                    country: country || '',
                    date: concert.date,
                    dateFormatted: dateFormatted,
                    time: time,
                    price: price,
                    allDates: concert.dates || [],
                    coordinates: concert.coordinates || null,
                    artistName: window.__ARTIST ? window.__ARTIST.name : '',
                    artistImage: window.__ARTIST ? window.__ARTIST.image : ''
                };
                
                const concertDataEncoded = JSON.stringify(concertData).replace(/'/g, "&#39;").replace(/"/g, "&quot;");
                
                return `
                    <div class="concert-card-enhanced" data-concert-index="${index}" data-concert-data="${concertDataEncoded}" style="cursor: pointer;" role="button" tabindex="0" aria-label="Réserver pour ${concert.displayLocation || concert.location} le ${dateFormatted}">
                        <div class="concert-date-badge">
                            <span class="date-day">${dayNum}</span>
                            <span class="date-month">${monthShort}</span>
                        </div>
                        <div class="concert-main-info">
                            <div class="concert-header-info">
                                <h3 class="concert-venue">${concert.displayLocation || concert.location}</h3>
                                ${city || country ? `<p class="concert-location-detail">${city}${city && country ? ', ' : ''}${country}</p>` : ''}
                            </div>
                            <div class="concert-details-grid">
                                <div class="concert-detail-item">
                                    <i class="fas fa-clock"></i>
                                    <span>${time}</span>
                                </div>
                                <div class="concert-detail-item">
                                    <i class="fas fa-ticket-alt"></i>
                                    <span>À partir de ${price}€</span>
                                </div>
                                <div class="concert-detail-item">
                                    <i class="fas fa-calendar-check"></i>
                                    <span>${dateFormatted}</span>
                                </div>
                            </div>
                        </div>
                        <div class="concert-action-icon">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Configurer les cartes
            setTimeout(() => {
                if (typeof setupConcertCards === 'function') {
                    setupConcertCards();
                }
            }, 100);
            
            return;
        }
        
        // Mettre à jour le compteur dans la sidebar
        const quickCount = document.getElementById('quick-upcoming-count');
        if (quickCount) {
            quickCount.textContent = upcomingConcerts.length;
        }
        
        // Afficher les concerts avec un design amélioré
        concertsList.innerHTML = upcomingConcerts.map((concert, index) => {
        const dateFormatted = formatConcertDate(concert.date);
        const time = generateRandomTime();
        const price = generateRandomPrice();
        
        // Extraire ville et pays depuis displayLocation si possible
        const locationParts = (concert.displayLocation || concert.location || '').split(',');
        const city = locationParts.length > 1 ? locationParts[locationParts.length - 2].trim() : '';
        const country = locationParts.length > 0 ? locationParts[locationParts.length - 1].trim() : '';
        
        // Extraire jour et mois pour l'affichage
        const [day, month, year] = concert.date.split('-').map(Number);
        const fullYear = year < 100 ? 2000 + year : year;
        const dateObj = new Date(fullYear, month - 1, day);
        const monthsShort = ['JAN', 'FÉV', 'MAR', 'AVR', 'MAI', 'JUN', 'JUL', 'AOÛ', 'SEP', 'OCT', 'NOV', 'DÉC'];
        const dayNum = day.toString().padStart(2, '0');
        const monthShort = monthsShort[month - 1];
        
        // Préparer les données du concert pour le modal avec toutes les informations
        const concertData = {
            location: concert.displayLocation || concert.location,
            city: city || '',
            country: country || '',
            date: concert.date,
            dateFormatted: dateFormatted,
            time: time,
            price: price,
            allDates: concert.dates || [],
            coordinates: concert.coordinates || null,
            artistName: window.__ARTIST ? window.__ARTIST.name : '',
            artistImage: window.__ARTIST ? window.__ARTIST.image : ''
        };
        
        // Vérifier les coordonnées
        const hasCoords = concert.coordinates && (concert.coordinates.latitude || concert.coordinates.lat);
        const coordsStr = hasCoords ? `${concert.coordinates.latitude || concert.coordinates.lat},${concert.coordinates.longitude || concert.coordinates.lng}` : '';
        
        // Encoder les données pour l'attribut HTML
        const concertDataEncoded = JSON.stringify(concertData).replace(/'/g, "&#39;").replace(/"/g, "&quot;");
        
        return `
            <div class="concert-card-enhanced" data-concert-index="${index}" data-concert-data="${concertDataEncoded}" style="cursor: pointer;" role="button" tabindex="0" aria-label="Réserver pour ${concert.displayLocation || concert.location} le ${dateFormatted}">
                <div class="concert-date-badge">
                    <span class="date-day">${dayNum}</span>
                    <span class="date-month">${monthShort}</span>
                </div>
                <div class="concert-main-info">
                    <div class="concert-header-info">
                        <h3 class="concert-venue">${concert.displayLocation || concert.location}</h3>
                        ${city || country ? `<p class="concert-location-detail">${city}${city && country ? ', ' : ''}${country}</p>` : ''}
                    </div>
                    <div class="concert-details-grid">
                        <div class="concert-detail-item">
                            <i class="fas fa-clock"></i>
                            <span>${time}</span>
                        </div>
                        <div class="concert-detail-item">
                            <i class="fas fa-ticket-alt"></i>
                            <span>À partir de ${price}€</span>
                        </div>
                        <div class="concert-detail-item">
                            <i class="fas fa-calendar-check"></i>
                            <span>${dateFormatted}</span>
                        </div>
                    </div>
                </div>
                <div class="concert-action-icon">
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
        `;
        }).join('');
        
        // Attendre un peu pour que le DOM soit complètement mis à jour
        setTimeout(() => {
            if (typeof setupConcertCards === 'function') {
                setupConcertCards();
            } else {
                console.error('Fonction setupConcertCards non disponible');
            }
        }, 100);
    }, 300);
}

// Fonction pour configurer les cartes de concerts
function setupConcertCards() {
    console.log('Configuration des cartes de concerts...');
    
    // Rendre toute la carte cliquable pour ouvrir le modal de réservation
    document.querySelectorAll('.concert-card-enhanced').forEach(card => {
        // Gestionnaire de clic
        const handleClick = function(e) {
            e.preventDefault();
            e.stopPropagation();
            try {
                const dataStr = this.getAttribute('data-concert-data');
                if (!dataStr) {
                    console.error('Données de concert manquantes');
                    return;
                }
                // Décoder les entités HTML
                const decodedStr = dataStr.replace(/&#39;/g, "'").replace(/&quot;/g, '"');
                const concertData = JSON.parse(decodedStr);
                console.log('Ouverture du modal de réservation:', concertData);
                if (typeof openBookingModal === 'function') {
                    openBookingModal(concertData);
                } else {
                    console.error('Fonction openBookingModal non disponible');
                    alert('Fonctionnalité de réservation en cours de chargement...');
                }
            } catch (error) {
                console.error('Erreur lors de l\'ouverture du modal:', error);
            }
        };
        
        // Ajouter l'événement de clic
        card.addEventListener('click', handleClick);
        
        // Ajouter le support du clavier (Entrée et Espace)
        card.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                handleClick.call(this, e);
            }
        });
        
        // Améliorer le style pour montrer que c'est cliquable
        card.style.transition = 'all 0.3s ease';
        card.style.userSelect = 'none';
    });
    
    console.log(`✅ ${document.querySelectorAll('.concert-card-enhanced').length} cartes de concerts configurées`);
}

// Fonction pour formater la date du concert
function formatConcertDate(dateStr) {
    try {
        const [day, month, year] = dateStr.split('-').map(Number);
        const fullYear = year < 100 ? 2000 + year : year;
        const date = new Date(fullYear, month - 1, day);
        const months = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 
                       'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'];
        const days = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];
        return `${days[date.getDay()]} ${day} ${months[month - 1]} ${fullYear}`;
    } catch {
        return dateStr;
    }
}

// Fonction pour générer une heure aléatoire
function generateRandomTime() {
    const hours = Math.floor(Math.random() * 3) + 19; // Entre 19h et 21h
    const minutes = Math.random() < 0.5 ? '00' : '30';
    return `${hours}:${minutes}`;
}

// Fonction pour générer un prix aléatoire
function generateRandomPrice() {
    const basePrices = [35, 45, 55, 65, 75, 85, 95];
    return basePrices[Math.floor(Math.random() * basePrices.length)];
}
</script>
<script src="/script/artist/member.js"></script>
<script src="/script/artist/booking.js"></script>
<script src="/script/artist/artist.js"></script>
{{end}}
